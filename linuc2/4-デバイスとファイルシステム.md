# デバイスとファイルシステム

## ファイルシステム操作

* VFS

### ファイルシステム情報

/etc/fstab

### mount/umout

### sync

* buffer cache
* page cache

### swap

## ファイルシステム作成

### ext2/ext3/ext4

### XFS

### BtrFS

### mkfsによる作成

### CD/DVD

### 暗号化ファイルシステム

## ファイルシステムの保守

### ファイルシステムの構造

* ext2/ext3
* ect4

### ファイルシステムのチェック

* fsck

### ファイルシステムの管理

### S.M.A.R.T

### XFS

### BtrFS

### オートマウント



### study-memo

## FileSystemの種類

| 名称 | 説明 |
| - | - |
| ext2 | Linux標準、古い |
| ext3 | ext2の後継、ジャーナリング機能がある |
| ext4 | ext3の後継、大容量のファイルシステムをサポート |
| xfs | 古くからありスナップショットの機能がある |
| btrfs | サブボリュームを構成し、スナップショットなどの機能を持つ |
| iso9660 | CD-ROMで使われる |
| FAT/VFAT | Windowsのファイルシステム、UEFIファームウェアのシステムパーティションや、ISOLINUXのイメージなどでも使われる |
| nfts | 近年のWindowsのファイルシステム |
| nfs | ネットワークファイルシステム |
| tmpfs | RAMディスク、メモリ上に配置される |
| swap | 物理メモリのスワップ先として利用される |
| ZFS | OracleのSolalisで使用される、btrfsが参考にした |

各ファイルシステム間の移行は、原則としては現行のデータをバックアップし、新しいファイルシステムを作成したのち、バックアップからコピーをするような形になりますが、一部のファイルシステム間では、コマンドにより変換が可能です。  
例えば、ext2ファイルシステムはtune2fsコマンドを使ってext3に変換が可能ですし、ext3ファイルシステムからbtrfsファイルシステムへの変換はbtrfs-convertというコマンドがあります。
## btrfs

* filesystem show : ファイルシステムの情報を表示する
* subvolume create : サブボリュームの作成
* subvolume delete : サブボリュームの削除
* subvolume list : サブボリュームの一覧表示
* subvolume snapshot : サブボリュームのsnapshot取得

## /etc/fstab

* 書式：  
「デバイス」 「マウント先」 「種類」 「オプション」 「dumpフラグ」 「fsckフラグ」

* オプション:
  * defaults : デフォルト
  * auto : mount -a による自動マウント
  * noauto : 自動マウントしない
  * ro : read only
  * rw : read write 
  * exec : 実行許可
  * noexec : 実行禁止
  * async : 非同期
  * sync : 同期
  * uid : マウントしたファイルシステムの所有者を指定
  * nouser : 一般ユーザによるマウントを禁止
  * user : 一般ユーザによるマウントを許可、マウントしたユーザのみアンマウント可
  * users : 誰でもマウント、アンマウント可

## mount コマンド

* -a : /etc/mtab にあるファイルシステムをすべてマウント
* -o : マウントオプションを指定する
* -t : 指定した種類のファイルシステムのみを対象にする


## fuser コマンド

オプションを指定することで、指定したファイルシステムに対してアクセスを行っているプロセスの一覧を得たり、そのプロセスをすべて kill したりという動作が可能です。




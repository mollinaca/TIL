# Linuxカーネル

## ポイント

### バージョン
1桁目がメジャーバージョン、2桁目がマイナーバージョン、3桁目が安定板のリリース番号

### 確認コマンド

$ uname -[a|r|m]
$ cat /proc/version
$ head /usr/src/kernels/[version]/Makefile

### カーネルモジュール

コマンド
| コマンド名 | 意味 |
| - | - |
| lsmod | ロードされているモジュールをリスト表示 |
| insmod | モジュールをロードする |
| rmmod | モジュールをアンロードする |
| modprobe | 依存関係を解決してモジュールをロードもしくはアンロードする |
| depmod | モジュールの依存関係を更新する |
| modinfo | モジュールの情報を表示する |


### カーネルコンパイル

* ソースを用意する
* .configを設定
* コンパイル
* モジュールをコンパイル
* カーネルとモジュールを配置
* ブートローダの設定変更

コマンド  
$ make 

### カーネルパラメータの設定変更

```
$ sysctl -w [パラメータ]=[値]
```

### 初期RAMディスク

* initrd:ファイルシステムイメージを圧縮したもの、古い
* initramfs:ファイルシステムのドライバが不要、上位互換

$ mkinitrd [RAMディスクイメージファイル] [カーネルパージョン]  
$ mkinitramfs -o [RAMディスクイメージファイル] [カーネルバージョン]

Dracut:udevに対応

### カーネルの管理と問題解決

* /proc  
カーネル内のデータへのインタフェイスとなる特殊なファイルシステム
* コマンド  
  * $ lsdev  
  * $ lspci
  * $ lsusb

### デバイスファイル

* /dev ディレクトリ以下にある、デバイスを抽象化したファイル
  * ブロックデバイス：ファイルタイプb ブロック単位でデバイスにアクセス、HDD,RAM,などボリューム
  * キャラクタデバイス：ファイルタイプc 文字単位でデバイスにアクセス、キーボードやマウスなど、I/O
* /udev
  * あらかじめ /dev 配下に用意する必要があない動的なデバイスファイル管理、ユーザー空間、sysfsが /udev からのアクセスをカーネル空間とつなぐ
  * $ udevadm info  
  * $ udevadm monitor

  
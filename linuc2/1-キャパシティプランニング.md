# 1.キャパシティプランニング

## ポイント

* 要素ごとの監視コマンド、観測ポイント、予測ポイントを抑える
* 監視ツールの種類と特徴

## 総合的なリソース使用率のモニタリングツール

$ top  
$ vmstat  
$ iostat  
$ sar  
$ sadfuptime  
$ w  

### CPU使用率特化

$ ps  
$ lsof  

### メモリおよびスワップ領域

$ free  
$ swapon -s

### ディスク使用量

$ df 

### ネットワークトラフィック

$ netstat  
$ netserver  
$ netperf  
$ iptraf  

## リソース監視ツール

* collectd
* Nagios
* MRTG
* Cacti
* Ichiga2

## 需要の分析と将来予測について

* CPU
* メモリ
* ディスクI/O
* ネットワーク

## study-memo

sarのオプション  
※アップデートしてまとめる

```
       -R     Report memory statistics. The following values are displayed:

              frmpg/s
                     Number of memory pages freed by the system per second.  A negative value represents a number of  pages  allocated
                     by the system.  Note that a page has a size of 4 kB or 8 kB according to the machine architecture.

              bufpg/s
                     Number  of  additional memory pages used as buffers by the system per second.  A negative value means fewer pages
                     used as buffers by the system.

              campg/s
                     Number of additional memory pages cached by the system per second.  A negative value means  fewer  pages  in  the
                     cache.

       -r     Report memory utilization statistics.  The following values are displayed:

              kbmemfree
                     Amount of free memory available in kilobytes.

              kbmemused
                     Amount of used memory in kilobytes. This does not take into account memory used by the kernel itself.

              %memused
                     Percentage of used memory.

              kbbuffers
                     Amount of memory used as buffers by the kernel in kilobytes.

              kbcached
                     Amount of memory used to cache data by the kernel in kilobytes.

              kbcommit
                     Amount  of memory in kilobytes needed for current workload. This is an estimate of how much RAM/swap is needed to
                     guarantee that there never is out of memory.

              %commit
                     Percentage of memory needed for current workload in relation to the total amount of memory (RAM+swap).  This num‐
                     ber may be greater than 100% because the kernel usually overcommits memory.

              kbactive
                     Amount  of  active  memory in kilobytes (memory that has been used more recently and usually not reclaimed unless
                     absolutely necessary).

              kbinact
                     Amount of inactive memory in kilobytes (memory which has been less recently used.  It  is  more  eligible  to  be
                     reclaimed for other purposes).

              kbdirty
                     Amount of memory in kilobytes waiting to get written back to the disk.

```

### グラフィカルなリソースモニタ?  
 * collectd
 * Nagios
 * MRTG（Multi Router Traffic Grapher）
 * Cacti
 * Icinga2

### ps 
* USER ユーザ名
* PID プロセスID
* %CPU CPUの使用率
* %MEM 物理メモリの使用率
* VSZ 仮想メモリのサイズ(KB)
* RSS 使用中の物理メモリのサイズ(KB) 
* TTY 制御端末名
* STAT プロセスの状態と優先度
* START 実行開始時刻
* TIME 消費したCPU時間
* COMMAND 実行コマンド

### ディスクI/O
vmstat/iostat/sar -b

### CPU負荷
top/vmstat/w/sar -u

### swap領域
swapon -s/sar -S

### 物理メモリ
top/ps aux


# システムの起動

## ポイント

### システム起動プロセス

* BIOS(Basic Input/Output System)
* UEFI(Unified Extensible Firmware Interface)
* MBR/GPT(Master Boot Record/GUID Partition Table)
* BootLoader(GRUB Legacy/GRUB2)
* Kernel

### SysVinit

init -> /etc/inittab  
init -> /etc/rc.sysinit  
init -> /etc/rc  
/etc/rc -> /etc/rc [runlevel].d

SysVinit もそれなりに出題されるぽいのでおさらいしておく...

* 起動スクリプト
* ランレベル
* service
* chkconfig
* update-rc.d

### systemd

| プロセス | 説明 |
| - | - |
| systemd | systemd メインプロセス |
| systemd-journal | ジャーナル（ログ）管理プロセス |
| systemd-logind | ログイン処理プロセス |
| systemd-udevd | デバイス動的検知プロセス |

* systemctl
  * start:サービス起動
  * stop:サービス終了
  * restart:サービス再起動
  * reload:設定再読み込み
  * status:稼働状況確認
  * is-active:起動しているかどうかを確認
  * enable:自動起動有効化
  * disable:自動起動無効化
  * list-units:起動しているUnitを表示
  * list-unit-files:全てのUnitを表示
  * list-dependencies:指定したサービスが必要とするUnitを表示する
* Unit設定ファイル
* Journal(ログ)
  * journalctl

### ブートローダ

* GRUB Legacy
* GRUB2

のオプションとか起動パラメータとか。。  

* SYSLINUX:USBメモリやCD-ROMなどのメディアからのブート
* PXE:ネットワークドライブからのブート

### システムの回復

* レスキューモード

### study-memo

*システム起動のカスタマイズ*

* バージョン6.0より前のDebian GNU/Linux(?)  
 sshdを自動起動しないようにするためには  
  * update-uc.d のremoveを-fで実行
  * /etc/rc[0-6].d/ 内のsshdを削除する

* /etc/inittabの記述例  
  ID:RunLevel:Act:Cmd  
  id:3:initdefault:  

* Act
  * initdefault デフォルトランレベルを指定
  * once 指定ランレベルになった際一度だけ実行
  * wait onceと同様だが、プロセスの終了を待つ
  * boot ブート時に実行
  * bootwait bootと同様だが、プロセスの終了を待つ
  * sysinit bootと同様だが、より先に実行する
  * respawn プロセスが終了しても自動的に再起動させる

* RunLevel
  * 0 poweroff.target
  * 1 rescure.target
  * 2-4 multi-user.target
  * 5 graphical.target
  * 6 reboot.target

* systemdでのディレクトリなど

| ディレクトリ | 説明 |
| - | - |
| /usr/lib/systemd/system | 永続的なユニットターゲットの定義ファイルが置かれる |
| /etc/systemd/system | カスタム用ディレクトリ |
| /run/systemd/system | 再起動すると削除される |

* SUSEでの自動起動設定コマンド
  * insserv

※明日はシステムの起動の後半から
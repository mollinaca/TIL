
# 1.脅威とサイバー攻撃の手法

## 1.1 情報セキュリティとは

CIA

* C: Confidentiality 機密性
アクセスコントロール、ある情報を許可された利用者だけが許可された範囲内で利用できること
認証認可の正常性

I: Integrity 完全性
インテグリティ、情報が正確、完全であること

A: Availability 可用性
情報が利用可能であること、その状態の保証
99.999% ファイブナイン

攻撃者だけが敵ではない
操作ミスや、自然災害など

情報セキュリティはコスト項目であり
コストとセキュリティのバランスポイントが大事、ROI

監査
* 信頼性の監査
フォールトトレラント
* 安全性の監査
アクセス管理機能の検証
* 効率性の監査
など

## 1.2 リスク

情報資産と脅威

情報資産; 自社が持つ情報セキュリティの中で保護されるべき対象
→それを脅かすものが脅威

情報資産管理台帳

### 脆弱性

リスクを顕在化させる状態
物理的脆弱性; 社屋やコンピュータルームが耐震構造になってないとか、マシンルームに可燃物が放置されているとかそういう話
ファシリティチェック; 社屋に入れる人員を適切にコントロールすること、入退室管理、バイオメトリクス認証など
機器故障対策; 機器の二重化、寿命前に機器を交換するなど
紛失対策: 認証や、保存データの暗号化など

状況的犯罪予防、割れ窓理論
犯罪を起こしにくい環境を整えていくことで、結果的に犯罪を起こさせないようにするという考え方

### 技術的脆弱性

ソフトウェア製品のセキュリティホール、コンピュータシステムへのウィルスの混入、アクセスコントロールのみ実施など、システムの設定やアップデートによってコントロールが可能な弱点

アクセスコントロールの不備
パスワードなどによりアクセスがコントロールされていない場合や、既知のものである場合は、不適切なユーザに情報資産をアクセスされる脆弱性が発生しうる
外部からだけでなく、内部犯もありうる
外部犯については、不正アクセス禁止法の施行により法的な罰則根拠が発生したが、罰則が適用されるためにはそもそもアクセスコントロールが実施されているシステムに限られる

コンピュータウィルス対策の不備
システムの中へ侵入し、改ざんや破壊、漏洩を行う
様々な手段で恒常的にシステムへのアクセスを試みている
何らかの形で外界とのアクセス経路が存在するシステムでは、もれなくウィルス対策が必要である

セキュリティホール
OSやアプリケーションの設計上、プログラミング上の瑕疵により、正当な権限をもっていないユーザでもシステムにアクセスできたり
任意のプログラムを実行できたりする欠陥をセキュリティホールという
セキュリティホールそのものは脆弱性であり、直接のリスクではないが、リスクに結びつく可能性が非常に高い
ワープロや表計算ソフトのマクロ機能を悪用したマクロウィルス

### 人的脆弱性

内部犯による情報誌資源の持ち出しや、オペレータの過失によるデータの喪失、ご入力など
人（多くの場合内部社員）が介在する弱点

組織管理の不備
罰則
権限の明確化

#### リスクの顕在化

脅威が存在しても、脆弱性がなければリスクは現実のものになりません（顕在化しない）
脆弱性があっても、脅威がなければリスクにはならない
脆弱性と脅威が一体化したときに、情報資産に対するリスクが発生する
リスク=情報資産+脅威+脆弱性

## 脅威の種類

物理的脅威
火災、自身、落雷、停電、侵入者による物理的な破壊、盗難、過失による機器、データの破壊、機器の故障

技術的脅威
不正アクセス、バッファオーバフロー、パスワード奪取、セッションハイジャック、盗聴、なりすまし、DoS攻撃、ビーコン、フィッシングなどWebシステムへの攻撃、スクリプト攻撃、DNSキャッシュポイズニング、標的型攻撃、コンピュータウィルス、マルウェア、ソフトウェアのバグ

人的脅威
ミスによるデータ、機器の破壊や、内部犯による確信的な犯行
内部犯、人的ミス、サボタージュ（単なる作業サボりではなく、指示されたセキュリティ規則に従わないなど


## 攻撃者

攻撃者の目的？
知的好奇心、金銭、自己顕示欲、講義目的、諜報目的、破壊、

ブラックハッカー: 職業的攻撃者
ホワイトハッカー: 良識的なハッカー、技術者

ハクティビスト: 政治的な主張を目的とする
スクリプトキディ: ITスキルがあまりないユーザのうち、いたずら目的や愉快犯のもの、スキルがなくても、ツールを使い簡単に攻撃を行えるようになった

内部犯: 正当なシステム権限を用いて情報資産を盗用したり流用したり
サイバーテロリズム: 社会インフラが情報システムへの依存を高める中で、サイバーテロは特に先進国にとって空爆などと同等の驚異になりうる

不正のトライアングル
不正が行われるには、機会と動機と正当化の3つがそろったとき、という考え方

## 情報収集と共有

脆弱性情報を共通化、標準化した形で蓄積、公開すること
JVN,CVE,CVSS,CWE

データベース
* JVN: Japan Vulnerability Notes
日本のデータベース、JPCERT/CC,IPAが共同管理している
* CVE: Common Vulnerabilities and Exposures
アメリカの非営利団体MITREが管理している脆弱性データベース、CVEは共通脆弱性識別子をつけて管理する

標準化
* CVSS: Common Vulnerability Scoring System
ベンダに依存しない汎用的な評価基準
基本評価基準、CVSS基本値
現状評価基準、CVSS現状値
環境評価基準、CVSS環境値
* CWE: 共通脆弱性タイプ一覧
ビュー 特定の観点でグループ化したもの
カテゴリ 特性のよってグループ化
脆弱性 クラス、ベース、バリアントなどの分類、クラスは抽象的、バリアントは具体的
複合要因 複数の要因が絡む脆弱性を表現する

### 公開タイミングとExploit

Exploit: 脆弱性に対して攻撃が可能であることを示すためのコード、脆弱性の有無を検査するためのツールになるが、そのまま攻撃用ツールへの転用ができる

J-CSIP: サイバー情報共有イニシアティブ、IPAが管理、運用している。サイバー攻撃などに対する情報を溶融することが目的

## サイバー攻撃の手法

### 主なサイバー攻撃の手法

※参考書で説明があるもの、例
ポートスキャン
バッファオーバーフロー
パスワード奪取
セッションハイジャック
盗聴
なりすまし
DoS攻撃
スパムメール
Webシステムへの攻撃
フィッシング
XSS
SQLインジェクション
DNSキャッシュポイズニング
ソーシャルエンジニアリング


## 不正アクセス

不正アクセスの準備行為として、ポートスキャン
システムを利用するものが、その与えられた権限によって許された以上の行為をネットワークを介して意図的に行うことを不正アクセスという

不正アクセス禁止法: ネットワークを通じてのアクセスであること、保護対象はアクセスコントロールされているシステムであること
* ネットワークを媒介する
* アクセスコントロールされているシステムへの攻撃
* セキュリティホールを突く
* 不正IDやパスワードを使用する

### 不正アクセスの方法

攻撃対象を選別する手法として、ネットワークスキャン、ping
→ping応答をしないステルスモード（IPMIパケットドロップ）

ネットワークスキャンでリーチできる対象を見つけたら、ポートスキャン
ポートスキャンで、リーチできるアプリケションを特定できたら、そのコンピュータがどのような用途で使われているか判明する
ポートスキャン、TCP3ウェイハンドシェイク、

ポートスキャンの種類
* TCPスキャン; 3ウェイハンドシェイクを行う
* SYNスキャン: 3ウェイハンドシェイクの最初のSYNだけを送る、ログが残らないため、ハーフオープンスキャン、ステルススキャンとも呼ばれる
* FINスキャン: FINを送信する、ポートが閉じていれば何も帰ってこないが、開いていればRSTが期待できる。ログに残らないためステルススキャンできる
* NULLスキャン: TCPのフラグをすべてNULLにして送信する、ポートが閉じていれば何も帰ってこないが、あいていればRSTが期待できる、ログに残らないためステルススキャンできる

ポートスキャンの対策
* 不要なポートはあけない
* 開放する場合も、相手のIPアドレスを認証するなどの措置をとる

## バッファオーバーフロー

典型的な攻撃手法

* スタック攻撃
* ヒープ攻撃

対策
* そもそも脆弱性を持たせない、古のCライブラリ、コマンドを使わない
* DEP データ実行防止
* ASLR アドレス空間配置ランダム化

## パスワード奪取

* ブルートフォースアタック
* 辞書攻撃
* レインボーテーブル

侵入に成功すると、
* ログの消去
* バックドア作成

## セッションハイジャック

二者間で行われている通信（セッション）を乗っ取る攻撃
サーバになりすましたり、クライアントになりすましたりする
MITM: 中間者攻撃

対策
* セッションIDの割当に乱数を使う（推測されにくくする）
* 暗号化と認証
* （UDP)ポート番号をランダムにする

*セッションフィクセーション*  
セッションIDをFIX、すなわち固定することで、なりすましを行う、セッションIDの固定化攻撃

対策
* セッション番号の有効期限を短くする
* セッションIDがログインごとに変更されるようにする




